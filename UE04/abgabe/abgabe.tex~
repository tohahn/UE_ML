\documentclass[a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{caption}

\lstset{
	basicstyle=\footnotesize,
	tabsize=3,
	title=\lstname,
	breaklines=true
}

\addtolength{\oddsidemargin}{-.875in}
\addtolength{\evensidemargin}{-.875in}
\addtolength{\textwidth}{1.75in}

\addtolength{\topmargin}{-.875in}
\addtolength{\textheight}{1.75in}

\title{Machine Learning Übungsblatt 4}
\author{Ramon Leiser\and Tobias Hahn}

\begin{document}
\maketitle
\newpage
\section{Begriffsdefinitionen}

\subsection{Würfelmodell}
Um das Modell zu erstellen müssen wir zuerst einem den Würfel auswählen der den Würfel auswählt. Der W4 fällt weg, da der zuwenig Seiten hat um aus 6 Würfeln sich für einen zu entscheiden. Wir wählen daher den W6 als festlegenden Würfel. Dabei ist es so, dass die Würfel mit aufsteigender Augenzahl auch mit aufsteigender Augenzahl ausgewählt werden - also wenn 1 gewürfelt wird wird W4 angezeigt, wenn 2 gewürfelt wird W6 und so weiter. Die Zustände die wir haben sind also festgelegt durch die Würfe des W6. Diese sind unabhängig von dem vorherigen Wurf, da das bei einem Würfel so ist.

\subsubsection{Transitionsmodell}
\begin{tabular}{|c|c|}
\hline
Wurf(W6) & P(Wurf(W6)) \\\hline
1 & 1/6 \\
2 & 1/6 \\
3 & 1/6 \\
4 & 1/6 \\
5 & 1/6 \\
6 & 1/6 \\\hline
\end{tabular}
\captionof{table}{Transitionsmodell}

\paragraph{}
Das Sensormodell hat die Aufgabe, uns für einen Zustand anzugeben welche Beobachtungen wie wahrscheinlich sind. Hier ist es allgemein so, dass bei dem Zustand für den Wurf mit W6 jeweils die Augenzahlen der jeweiligen Würfel gleich wahrscheinlich sind. D.h. wenn der Zustand 1 ist, dann sind 1-4 die möglichen Beobachtungen mit jeweils ein Viertel Wahrscheinlichkeit. Die einzige Ausnahme ist Zustand 2, da sich hier der W6 selber auswählt, wir also schon wissen dass die Beobachtung 2 ist. Dementsprechend sehen die Sensormodelle so aus:

\subsubsection{Sensormodell}
\subsubsection{Transitionsmodell}
\begin{tabular}{|c|c|c|}
\hline
Beobachtung x & Zustand y & P(x|y) \\\hline
1 & 1 & 0.25\\
2 & 1 & 0.25 \\
3 & 1 & 0.25 \\
4 & 1 & 0.25 \\\hline
2 & 2 & 1 \\\hline
1 & 3 & 1/8 \\
2 & 3 & 1/8 \\
... & ... & ... \\\hline
1 & 4 & 1/12 \\
2 & 4 & 1/12 \\
... & ... & ... \\\hline
1 & 5 & 1/20 \\
2 & 5 & 1/20 \\
... & ... & ... \\\hline
1 & 6 & 1/100 \\
2 & 6 & 1/100 \\
... & ... & ... \\\hline
\end{tabular}
\captionof{table}{Sensormodell}


\section{Markov Ketten}

\section{Hidden Markov Modell}

\subsection{Modelle}

\begin{tabular}{|c|c|c|}
\hline
Spielstandsänderung(t) & Spielstandsänderung(t+1) & P(Spielstandsänderung(t+1)|Spielstandsänderung(t)) \\\hline
KÄ & KÄ & 0.6 \\
KÄ & TG & 0.2 \\
KÄ & TW & 0.2 \\\hline
TW & KÄ & 0.4 \\
TW & TG & 0.3 \\
TW & TW & 0.3 \\\hline
TG & KÄ & 0.4 \\
TG & TG & 0.4 \\
TG & TW & 0.2 \\\hline
\end{tabular}
\captionof{table}{Transitionsmodell}

\begin{tabular}{|c|c|c|}
\hline
Laut & Spielstandsänderung & P(Laut|Spielstandsänderung) \\\hline
Ole & KÄ & 0.8 \\
Toor & KÄ & 0.05 \\
Ohhh & KÄ & 0.15 \\\hline
Ole & TG & 0.1 \\
Toor & TG & 0.2 \\
Ohhh & TG & 0.7 \\\hline
Ole & TW & 0.1 \\
Toor & TW & 0.8 \\
Ohhh & TW & 0.1 \\\hline
\end{tabular}
\captionof{table}{Sensormodell}

\begin{tabular}{|c|c|}
\hline
Zustand & P(Zustand) \\\hline
KÄ & 0.33 \\
TG & 0.33 \\
TW & 0.33 \\\hline
\end{tabular}
\captionof{table}{A priori Wahrscheinlichkeiten}

\subsection{FORWARD-Algorithmus}
\subsubsection{Berechnungen}
\begin{lstlisting}
Calculations
P(KAE|Ole) = P(Ole|KAE) * (P(KAE|KAE) * P(KAE) + P(KAE|TW) * P(TW) + P(KAE|TG) * P(TG)) = 0.26664 ~= 0.824742268041
P(TW|Ole) = P(Ole|TW) * (P(TW|KAE) * P(KAE) + P(TW|TW) * P(TW) + P(TW|TG) * P(TG)) = 0.03333 ~= 0.103092783505
P(TG|Ole) = P(Ole|TG) * (P(TG|KAE) * P(KAE) + P(TG|TW) * P(TW) + P(TG|TG) * P(TG)) = 0.023331 ~= 0.0721649484536

Scores
+-------+--------------------+
| Score | Wahrscheinlichkeit |
+-------+--------------------+
| 0:0   | 0.825              |
+-------+--------------------+
| 1:0   | 0.103              |
+-------+--------------------+
| 0:1   | 0.072              |
+-------+--------------------+

Calculations
P(KAE|Ole) = P(Ole|KAE) * (P(KAE|KAE) * P(KAE) + P(KAE|TW) * P(TW) + P(KAE|TG) * P(TG)) = 0.423917525773 ~= 0.864410342653
P(TW|Ole) = P(Ole|TW) * (P(TW|KAE) * P(KAE) + P(TW|TW) * P(TW) + P(TW|TG) * P(TG)) = 0.0382474226804 ~= 0.0779903300399
P(TG|Ole) = P(Ole|TG) * (P(TG|KAE) * P(KAE) + P(TG|TW) * P(TW) + P(TG|TG) * P(TG)) = 0.0282474226804 ~= 0.0575993273071

Scores
+-------+--------------------+
| Score | Wahrscheinlichkeit |
+-------+--------------------+
| 0:0   | 0.713              |
+-------+--------------------+
| 1:0   | 0.153              |
+-------+--------------------+
| 0:1   | 0.110              |
+-------+--------------------+
| 2:0   | 0.008              |
+-------+--------------------+
| 1:1   | 0.012              |
+-------+--------------------+
| 0:2   | 0.004              |
+-------+--------------------+

Calculations
P(KAE|Ohhh) = P(Ohhh|KAE) * (P(KAE|KAE) * P(KAE) + P(KAE|TW) * P(TW) + P(KAE|TG) * P(TG)) = 0.0818646205592 ~= 0.255016109176
P(TW|Ohhh) = P(Ohhh|TW) * (P(TW|KAE) * P(KAE) + P(TW|TW) * P(TW) + P(TW|TG) * P(TG)) = 0.0386441034265 ~= 0.120380071771
P(TG|Ohhh) = P(Ohhh|TG) * (P(TG|KAE) * P(KAE) + P(TG|TW) * P(TW) + P(TG|TG) * P(TG)) = 0.200508723986 ~= 0.624603819053

Scores
+-------+--------------------+
| Score | Wahrscheinlichkeit |
+-------+--------------------+
| 0:0   | 0.182              |
+-------+--------------------+
| 1:0   | 0.125              |
+-------+--------------------+
| 0:1   | 0.473              |
+-------+--------------------+
| 2:0   | 0.021              |
+-------+--------------------+
| 1:1   | 0.112              |
+-------+--------------------+
| 0:2   | 0.070              |
+-------+--------------------+
| 3:0   | 0.001              |
+-------+--------------------+
| 2:1   | 0.006              |
+-------+--------------------+
| 1:2   | 0.008              |
+-------+--------------------+
| 0:3   | 0.003              |
+-------+--------------------+

Calculations
P(KAE|Ole) = P(Ole|KAE) * (P(KAE|KAE) * P(KAE) + P(KAE|TW) * P(TW) + P(KAE|TG) * P(TG)) = 0.241605154936 ~= 0.814292871441
P(TW|Ole) = P(Ole|TW) * (P(TW|KAE) * P(KAE) + P(TW|TW) * P(TW) + P(TW|TG) * P(TG)) = 0.0325501610918 ~= 0.109705292291
P(TG|Ole) = P(Ole|TG) * (P(TG|KAE) * P(KAE) + P(TG|TW) * P(TW) + P(TG|TG) * P(TG)) = 0.0225501610918 ~= 0.0760018362676

Scores
+-------+--------------------+
| Score | Wahrscheinlichkeit |
+-------+--------------------+
| 0:0   | 0.148              |
+-------+--------------------+
| 1:0   | 0.122              |
+-------+--------------------+
| 0:1   | 0.399              |
+-------+--------------------+
| 2:0   | 0.030              |
+-------+--------------------+
| 1:1   | 0.153              |
+-------+--------------------+
| 0:2   | 0.093              |
+-------+--------------------+
| 3:0   | 0.003              |
+-------+--------------------+
| 2:1   | 0.019              |
+-------+--------------------+
| 1:2   | 0.022              |
+-------+--------------------+
| 0:3   | 0.007              |
+-------+--------------------+
| 4:0   | 0.000              |
+-------+--------------------+
| 3:1   | 0.001              |
+-------+--------------------+
| 2:2   | 0.001              |
+-------+--------------------+
| 1:3   | 0.001              |
+-------+--------------------+
| 0:4   | 0.000              |
+-------+--------------------+

Calculations
P(KAE|Toor!) = P(Toor!|KAE) * (P(KAE|KAE) * P(KAE) + P(KAE|TW) * P(TW) + P(KAE|TG) * P(TG)) = 0.0262858574288 ~= 0.0677968291844
P(TW|Toor!) = P(Toor!|TW) * (P(TW|KAE) * P(KAE) + P(TW|TW) * P(TW) + P(TW|TG) * P(TG)) = 0.305143429715 ~= 0.78702994708
P(TG|Toor!) = P(Toor!|TG) * (P(TG|KAE) * P(KAE) + P(TG|TW) * P(TW) + P(TG|TG) * P(TG)) = 0.0562858574288 ~= 0.145173223736

Scores
+-------+--------------------+
| Score | Wahrscheinlichkeit |
+-------+--------------------+
| 0:0   | 0.010              |
+-------+--------------------+
| 1:0   | 0.125              |
+-------+--------------------+
| 0:1   | 0.049              |
+-------+--------------------+
| 2:0   | 0.098              |
+-------+--------------------+
| 1:1   | 0.342              |
+-------+--------------------+
| 0:2   | 0.064              |
+-------+--------------------+
| 3:0   | 0.024              |
+-------+--------------------+
| 2:1   | 0.126              |
+-------+--------------------+
| 1:2   | 0.097              |
+-------+--------------------+
| 0:3   | 0.014              |
+-------+--------------------+
| 4:0   | 0.002              |
+-------+--------------------+
| 3:1   | 0.016              |
+-------+--------------------+
| 2:2   | 0.021              |
+-------+--------------------+
| 1:3   | 0.009              |
+-------+--------------------+
| 0:4   | 0.001              |
+-------+--------------------+
| 5:0   | 0.000              |
+-------+--------------------+
| 4:1   | 0.001              |
+-------+--------------------+
| 3:2   | 0.001              |
+-------+--------------------+
| 2:3   | 0.001              |
+-------+--------------------+
| 1:4   | 0.000              |
+-------+--------------------+
| 0:5   | 0.000              |
+-------+--------------------+
\end{lstlisting}

\subsubsection{A priori Verteilung}
Die Wahl einer gleichverteilten a priori Verteilung erscheint mir sinnvoll, da man ja am Anfang nichts über das Spiel weiß und daher auch keine Annahmen darüber treffen sollte. Nun könnte man natürlich auch sagen dass man schon etwas allgemeines über das Spiel aussagen könnte, wie z.B. dass Werder Bremen eine eher schlechte Mannschaft ist, dass daher die a priori Wahrscheinlichkeit für TW niedriger, die a priori Wahrscheinlichkeit für TG eher höher angesetzt werden sollte. Andererseits könnte man behaupten dass es relativ sicher ist dass es ein Geräusch gibt wenn ein Tor fällt, dass also die Wahrscheinlichkeit für TW und TG vor dem ersten Geräusch ziemlich niedrig ist. 
\end{document}
